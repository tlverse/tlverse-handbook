# Welcome to the `tlverse` {#intro}

## Learning Objectives
<!--- appears as "X.1: Learning Objectives" in the book, where X is the chapter
corresponding to stochastic interventions -->
1. Understand the `tlverse` concept
2. Identify the core components of the `tlverse`
3. Install `tlverse` R packages
4. Learn about the WASH Benefits example data

## What is the `tlverse`?

The `tlverse` is a new framework for doing Targeted Learning in R, inspired by
the [`tidyverse` ecosystem](https://tidyverse.org) of R packages.

By analogy to the [`tidyverse`](https://tidyverse.org/):

> The tidyverse is an opinionated collection of R packages designed for data
> science. All packages share an underlying design philosophy, grammar, and data
> structures. 

So, the [`tlverse`](https://tlverse.org) is

* an opinionated collection of R packages for Targeted Learning,
* sharing an underlying philosophy, grammar, and set of data structures.

## `tlverse` components

These are the main packages that represent the **core** of the `tlverse`:

* [`sl3`](https://github.com/tlverse/sl3): Modern Super Learning with Pipelines
  * _What?_ A modern object-oriented re-implementation of the Super Learner
    algorithm, employing recently developed paradigms for `R` programming.
  * _Why?_ A design that leverages modern tools for fast computation, is
    forward-looking, and can form one of the cornerstones of the `tlverse`.

* [`tmle3`](https://github.com/tlverse/tmle3): An Engine for Targeted Learning
  * _What?_ A generalized framework that simplifies Targeted Learning by
    identifying and implementing a series of common statistical estimation
    procedures.
  * _Why?_ A common interface and engine that accommodates current algorithmic
    approaches to Targeted Learning and is still flexible enough to remain the
    engine even as new techniques are developed.

In addition to the engines that drive development in the `tlverse`, there are
some supporting packages -- in particular, we have two...

* [`origami`](https://github.com/tlverse/origami): A Generalized Framework for
   Cross-Validation
  * _What?_ A generalized framework for flexible cross-validation
  * _Why?_ Cross-validation is a key part of ensuring error estimates are honest
    and preventing overfitting. It is an essential part of the both the Super
    Learner algorithm and Targeted Learning.

* [`delayed`](https://github.com/tlverse/delayed): Parallelization Framework for
   Dependent Tasks
  * _What?_ A framework for delayed computations (futures) based on task
    dependencies.
  * _Why?_ Efficient allocation of compute resources is essential when deploying
    large-scale, computationally intensive algorithms.

A key principle of the `tlverse` is extensibility. That is, we want to support
new Targeted Learning estimators as they are developed. The model for this is
new estimators are implemented in additional packages using the core packages
above. There are currently two featured examples of this:

* [`tmle3mopttx`](https://github.com/tlverse/tmle3mopttx): Optimal Treatments
  in `tlverse`
  * _What?_ Learn an optimal rule and estimate the mean outcome under the rule.
  * _Why?_ Optimal Treatment is a powerful tool in precision healthcare and
    other settings where a one-size-fits-all treatment approach is not
    appropriate.

* [`tmle3shift`](https://github.com/tlverse/tmle3shift): Shift Interventions in
  `tlverse`
  * _What?_ Shift interventions for continuous treatments.
  * _Why?_ Not all treatment variables are discrete. Being able to estimate the
    effects of continuous treatment represents a powerful extension of the
    Targeted Learning approach.

## Installation

The `tlverse` ecosystem of packages are currently hosted at
https://github.com/tlverse, not yet on [CRAN](http://cran.r-project.org/). You
can use the `devtools` package to install them:

```{r installation, eval=FALSE}
install.packages("devtools")
devtools::install_github("tlverse/tlverse")
```

The `tlverse` depends on a large number of other packages that are also hosted
on GitHub. Because of this, you may see the followig error:
```
Error: HTTP error 403.
  API rate limit exceeded for 71.204.135.82. (But here's the good news: Authenticated requests get a higher rate limit. Check out the documentation for more details.)

  Rate limit remaining: 0/60
  Rate limit reset at: 2019-03-04 19:39:05 UTC

  To increase your GitHub API rate limit
  - Use `usethis::browse_github_pat()` to create a Personal Access Token.
  - Use `usethis::edit_r_environ()` and add the token as `GITHUB_PAT`.
```

This just means that R tried to install too many packages from GitHub in too
short of a window. To fix this, you need to tell R how to use github as your
user (you'll need a GitHub user account). Follow these two steps:

1. Use `usethis::browse_github_pat()` to create a Personal Access Token.
2. Use `usethis::edit_r_environ()` and add the token as `GITHUB_PAT`.

## Example Data - WASH Benefits

<!-- This will be it's own chapter written by Alan. Including an expert here for now -->
The data come from the Effect of water quality, sanitation, hand washing, and
nutritional interventions on child development in rural
Bangladesh (WASH Benefits Bangladesh):
a cluster-randomised controlled trial (@luby2018effects). The study enrolled
pregnant women in their first or second trimester from rural villages
of Gazipur, Kishoreganj, Mymensingh, and Tangail districts of central
Bangladesh, with an average
of eight women per cluster. Groups of eight geographically adjacent clusters
were block-randomised, using a random number generator, into six intervention
groups (all of which received weekly visits from a community health promoter
for the first 6 months and every 2 weeks for the next 18 months) and a
double-sized control group (no intervention or health promoter visit). The six
intervention groups were: chlorinated drinking water; improved sanitation;
handwashing with soap; combined water, sanitation, and handwashing; improved
nutrition through counselling and provision of lipid-based nutrient supplements;
and combined water, sanitation, handwashing, and nutrition. In the workshop, we
concentrate child-growth (size for age) as the outcome. This trial was
registered with ClinicalTrials.gov, number NCT01590095.
